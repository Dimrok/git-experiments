before_script:
  - |

       declare -r SSH_FILE="$(mktemp -u $HOME/.ssh/XXXXXX)"

       # - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - -

       # Decrypt the file containing the private key
       # (Note: this is the same as what is generated by the Travis CLI at step 2.5)

       openssl aes-256-cbc \
         -K ${!encrypted_key} \
         -iv ${!encrypted_iv} \
         -in ".travis/GitHub.enc" \
         -out "$SSH_FILE" -d

       # - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - -

       # Enable SSH authentication

       chmod 600 "$SSH_FILE" \
         && printf "%s\n" \
              "Host github.com" \
              "  IdentityFile $SSH_FILE" \
              "  LogLevel ERROR" >> ~/.ssh/config
  - git remote add GitHub git@github.com:$TRAVIS_REPO_SLUG.git
  - mkdir -p .meta/{status,duration,coverage}

script:
  - make

after_script:
  # Add tests status.
  - git checkout "$TRAVIS_COMMIT"
  - git fetch GitHub/meta
  - git checkout -b GitHub/meta
  - git add -f .meta/
  - git commit -m "$TRAVIS_COMMIT" --allow-empty
  - git push --force GitHub HEAD:refs/heads/meta

# blocklist
branches:
  except:
  - meta
